import{r as o,f as U,j as d,a,b as R,d as A,F as y}from"./app-bb1e6fde.js";import{U as E}from"./User-66e075da.js";import I from"./LoadingQuiz-e9b62240.js";import V from"./MulitplePilihan-852621ae.js";import G from"./YesNo-6475ec31.js";import H from"./SubmitData-4db7a7ce.js";import"./sweetalert2.all-cabaeae5.js";function $({target:v,kecamatan:b}){const[L,j]=o.useState(!1),[p,w]=o.useState([]);o.useState([]);const[c,g]=o.useState([]),[P,D]=o.useState(null),[x,F]=o.useState(null),N=o.useRef(null);o.useEffect(()=>{U.get(`/api/all-quiz/${v.id}`).then(i=>{let e=i.data.soal_general;i.data.soal_kecamatan.forEach(t=>{e.push(t)}),w(e),j(!0)}).catch(i=>{console.log("err",i)})},[]);const C=()=>{N.current.click()},M=i=>{if(i.target.files.length){D(i.target.files[0]);const e=new FileReader;e.readAsDataURL(i.target.files[0]),e.onload=function(t){let m=t.target.result;F(m)}}},z=(i,e,t)=>{let m=[],u=null;e.skip_soal&&(p.map((l,n)=>{var _,r;m.push(l),l.id===e.id&&(p[n+1].skip_soal_id!==e.id&&((_=e.skip_soal)==null?void 0:_.skip_if_yes_no)!==i?m.push(l.skip_soal):p[n+1].skip_soal_id===e.id&&((r=e.skip_soal)==null?void 0:r.skip_if_yes_no)===i&&(u=p.filter(f=>f.skip_soal_id!==e.id)))}),w(u||m));let s={soal_id:e.id,pilihan_id:null,yes_no:i},h=null;if(c.map(l=>{l.soal_id===e.id&&(h=e.id)}),h){let l=c.map(n=>n.soal_id===h?{...n,yes_no:i}:n);l.map((n,_)=>{var r,f;n.soal_id===((r=e.skip_soal)==null?void 0:r.skip_soal_id)&&i===((f=e.skip_soal)==null?void 0:f.skip_if_yes_no)&&(l=l.filter(k=>{var S;return k.soal_id!==((S=e.skip_soal)==null?void 0:S.id)}))}),console.log("newData",l),g(l)}else g(l=>[...l,s])},B=(i,e,t)=>{let m={soal_id:e.id,pilihan_id:i,yes_no:null},u=null;if(c.map(s=>{s.soal_id===e.id&&(u=e.id)}),u){let s=c.map(l=>l.soal_id===u?{...l,pilihan_id:i}:l),h=e;s.map((l,n)=>{var _,r;console.log("el",l),l.soal_id===((_=h.skip_soal)==null?void 0:_.skip_soal_id)&&i===((r=h.skip_soal)==null?void 0:r.skip_if_pilihan_id)&&(s=s.filter(f=>{var k;return console.log("item",f),f.soal_id!==((k=h.skip_soal)==null?void 0:k.id)}),console.log("newData",s))}),g(s)}else g(s=>[...s,m])};return o.useEffect(()=>{console.log("PilihanUser",c)},[c]),d(E,{children:[a(R,{title:"Mulai Survey"}),d("div",{className:"bg-slate-200 min-h-screen",children:[a("div",{className:"bg-yellow-600 h-36 w-full rounded-b-3xl",children:d(A,{href:"/list-survey",className:"flex items-center px-3 pt-2",children:[a("div",{className:"text-white",children:a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})})}),a("div",{className:"text-white ml-3",children:d("div",{className:"",children:["Survey Kec. ",b.nama]})})]})}),d("div",{className:"px-3 -mt-24 pb-32",children:[!L&&a(I,{}),p.map(i=>d("div",{className:"bg-white rounded-lg p-3 mb-4",children:[a("div",{className:"font-medium",children:i.title}),a("div",{className:"text-sm",children:i.subtitle}),a("div",{className:"mt-4",children:i.yes_no>0?a(G,{TempSoal:i,callbackData:(e,t)=>{z(e,t)}}):a(y,{children:a(V,{TempSoal:i,callBack:(e,t)=>{B(e,t)}})})})]},i.id)),a("input",{type:"file",ref:N,className:"",hidden:!0,accept:"image/*",capture:"camera",onChange:M}),a("div",{onClick:C,className:"flex flex-col items-center justify-center h-32 w-full bg-white rounded-lg mt-6",children:x?a("img",{src:x,alt:"",className:"h-32 mx-auto object-contain  text-center"}):d(y,{children:[a("div",{className:"bg-yellow-600 text-white h-14 w-14 flex justify-center items-center rounded-full",children:d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:[a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),a("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]})}),a("div",{className:"mt-2 text-sm",children:"Foto Bersama"})]})}),a("div",{className:"mt-4",children:a(H,{pilihan:c,soal:p,foto:P,target_id:v.id})})]})]})]})}export{$ as default};
