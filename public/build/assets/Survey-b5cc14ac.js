import{q as F,r as n,W as $,j as i,a as t,b as G,g as q,f as u}from"./app-7b371cb2.js";import{u as B}from"./index-1222a1f2.js";import{S as c}from"./sweetalert2.all-96585986.js";import{U}from"./User-4be47c98.js";function R({data_soal:H,session:b,provinsi:p,k:f}){const{errors:g}=F().props;n.useEffect(()=>{console.log("errors",g)},[g]);const{data:d,setData:h,post:O,processing:T}=$({nama:null,alamat:null}),[k,x]=n.useState(null),[v,y]=n.useState(null),[w,S]=n.useState([]),[_,N]=n.useState([]),[K,P]=n.useState([]),[l,m]=n.useState({provinsi_id:0,kota_id:0,kecamatan_id:0,desa_id:0}),{coords:s,isGeolocationAvailable:W,isGeolocationEnabled:z}=B({positionOptions:{enableHighAccuracy:!0}});n.useEffect(()=>{x(s==null?void 0:s.latitude),y(s==null?void 0:s.longitude)},[s]);const[A,r]=n.useState(!1);n.useEffect(()=>{navigator.geolocation.getCurrentPosition(e=>{r(!0)},e=>{c.fire({icon:"info",title:"Kami membutuhkan lokasi anda",text:"Aktifkan di pojok atas kiri tanda seru"}),r(!1)}),navigator.permissions.query({name:"geolocation"}).then(e=>{e.state==="denied"&&r(!1)})},[]),n.useState(!1);const D=()=>{if(!A)c.fire({icon:"info",title:"Kami membutuhkan lokasi anda",text:"Aktifkan di pojok atas kiri tanda seru"});else if(!d.nama||!d.alamat)c.fire({icon:"info",title:"Data tidak lengkap"});else{navigator.geolocation.getCurrentPosition(a=>{r(!0)},a=>{c.fire({icon:"info",title:"Kami membutuhkan lokasi anda",text:"Aktifkan di pojok atas kiri tanda seru"}),r(!1)});let e=null;if(l.provinsi_id?l.kota_id?l.kecamatan_id&&l.desa_id||(e="Kecamatan"):e="Kota":e="Provinsi",console.log("Alamat",l),e)c.fire({icon:"info",title:`Silahkan Pilih ${e}`,text:"Form Alamat Belum Lengkap"});else{let a={nama:d.nama,alamat:d.alamat,provinsi:l.provinsi_id,kota:l.kota_id,kecamatan:l.kecamatan_id,desa:l.desa_id};a.latitude=k,a.longitude=v,f&&(a.k=f),console.log("formData",a),q.post("/inputDataTarget",a)}}},C=e=>{let a=e.target.value;m({...l,provinsi_id:a}),a>0&&u.get(`/listKota?provinsi=${a}`).then(o=>{S(o.data.data)}).catch(o=>{console.log("err",o)})},j=e=>{let a=e.target.value;m({...l,kota_id:a}),a>0&&u.get(`/listKecamatan?kota=${a}`).then(o=>{N(o.data.data)}).catch(o=>{console.log("err",o)})},L=e=>{let a=e.target.value;m({...l,kecamatan_id:a}),a>0&&u.get(`/listDesa?kecamatan=${a}`).then(o=>{P(o.data.data)}).catch(o=>{console.log("err",o)})},E=e=>{let a=e.target.value;console.log("value",a),m({...l,desa_id:a})};return i(U,{children:[t(G,{title:"Survey"}),i("div",{className:"min-h-screen  flex justify-center flex-col items-center px-3",children:[b.success&&t("div",{className:"bg-yellow-100 w-full rounded-lg px-2 text-sm mb-4",children:t("div",{className:"font-medium w-full py-2  block",children:"Berhasil simpan data"})}),i("label",{className:"block w-full",children:[t("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Nama"}),t("input",{type:"text",name:"nama",onChange:e=>h("nama",e.target.value),className:"mt-1 px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),i("label",{className:"block w-full mt-6",children:[t("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Alamat"}),t("input",{type:"text",name:"nik",onChange:e=>h("alamat",e.target.value),className:"mt-1 px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),t("label",{htmlFor:"provinsi",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Provinsi"}),i("select",{id:"provinsi",onChange:C,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[t("option",{value:0,children:"Pilih provinsi"}),p.map(e=>t("option",{value:e.id_provinsi,children:e.nama},e.id))]}),t("label",{htmlFor:"kota",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Kota/Kabupaten"}),i("select",{id:"kota",onChange:j,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[t("option",{value:0,children:"Pilih kota"}),w.map(e=>t("option",{value:e.id_kota,children:e.nama},e.id))]}),t("label",{htmlFor:"kecamatan",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Kecamatan"}),i("select",{id:"kecamatan",onChange:L,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[t("option",{value:0,children:"Pilih Kecamatan"}),_.map(e=>t("option",{value:e.id_kecamatan,children:e.nama},e.id))]}),t("label",{htmlFor:"desa",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Desa"}),i("select",{id:"desa",onChange:E,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[t("option",{value:0,children:"Pilih Desa"}),K.map(e=>t("option",{value:e.id,children:e.nama},e.id))]}),t("div",{className:" text-center w-full mt-3",children:t("div",{className:"mt-4 bg-yellow-600 text-center py-2  px-10 rounded-lg text-white w-full",onClick:D,children:"Daftar"})})]})]})}export{R as default};
