import{r as l,W as _,j as v,a as i,b as I,g as K}from"./app-eb2c3c80.js";import{S as x}from"./sweetalert2.all-05871ff2.js";import{U as R}from"./User-10e23f78.js";var P={};Object.defineProperty(P,"__esModule",{value:!0});var D=P.useGeolocated=void 0;const a=l;function U(C={}){const{positionOptions:g={enableHighAccuracy:!0,maximumAge:0,timeout:1/0},isOptimisticGeolocationEnabled:r=!0,userDecisionTimeout:c=void 0,suppressLocationOnMount:E=!1,watchPosition:p=!1,geolocationProvider:o=typeof navigator<"u"?navigator.geolocation:void 0,watchLocationPermissionChange:w=!1,onError:u,onSuccess:d}=C,m=(0,a.useRef)(0),n=(0,a.useRef)(!0),h=(0,a.useRef)(0),[N,b]=(0,a.useState)(r),[s,k]=(0,a.useState)(),[e,y]=(0,a.useState)(),[T,A]=(0,a.useState)(),[L,M]=(0,a.useState)(),f=(0,a.useCallback)(()=>{m.current&&window.clearTimeout(m.current)},[]),S=(0,a.useCallback)(t=>{f(),n.current&&(k(()=>{}),b(!1),A(t)),u==null||u(t)},[u,f]),G=(0,a.useCallback)(t=>{f(),n.current&&(k(t.coords),y(t.timestamp),b(!0),A(()=>{})),d==null||d(t)},[d,f]),j=(0,a.useCallback)(()=>{if(!o||!o.getCurrentPosition||!o.watchPosition)throw new Error("The provided geolocation provider is invalid");const t=(p?o.watchPosition:o.getCurrentPosition).bind(o);c&&(m.current=window.setTimeout(()=>{S()},c)),h.current=t(G,S,g)},[o,p,c,S,G,g]);return(0,a.useEffect)(()=>{let t;return w&&o&&"permissions"in navigator&&navigator.permissions.query({name:"geolocation"}).then(O=>{t=O,t.onchange=()=>{M(t.state)}}),()=>{t&&(t.onchange=null)}},[]),(0,a.useEffect)(()=>(E||j(),()=>{f(),p&&h.current&&(o==null||o.clearWatch(h.current))}),[L]),{getPosition:j,coords:s,timestamp:e,isGeolocationEnabled:N,isGeolocationAvailable:!!o,positionError:T}}D=P.useGeolocated=U;function W({data_soal:C,session:g}){const{data:r,setData:c,post:E,processing:p,errors:o}=_({nama:null,alamat:null}),[w,u]=l.useState(null),[d,m]=l.useState(null),{coords:n,isGeolocationAvailable:h,isGeolocationEnabled:N}=D({positionOptions:{enableHighAccuracy:!0}});l.useEffect(()=>{u(n==null?void 0:n.latitude),m(n==null?void 0:n.longitude),console.log("coords",n)},[n]);const[b,s]=l.useState(!1);l.useEffect(()=>{navigator.geolocation.getCurrentPosition(e=>{s(!0)},e=>{x.fire({icon:"info",title:"Kami membutuhkan lokasi anda",text:"Aktifkan di pojok atas kiri tanda seru"}),s(!1)}),navigator.permissions.query({name:"geolocation"}).then(e=>{e.state==="denied"&&s(!1)})},[]),l.useState(!1);const k=()=>{if(!b)x.fire({icon:"info",title:"Kami membutuhkan lokasi anda",text:"Aktifkan di pojok atas kiri tanda seru"});else if(!r.nama||!r.alamat)x.fire({icon:"info",title:"Data tidak lengkap"});else{navigator.geolocation.getCurrentPosition(y=>{s(!0),console.log("data",r)},y=>{x.fire({icon:"info",title:"Kami membutuhkan lokasi anda",text:"Aktifkan di pojok atas kiri tanda seru"}),s(!1)});let e=r;e.latitude=w,e.longitude=d,console.log("formData",e),K.post("/inputDataTarget",e)}};return v(R,{children:[i(I,{title:"Survey"}),v("div",{className:"min-h-screen  flex justify-center flex-col items-center px-3",children:[g.success&&i("div",{className:"bg-green-100 w-full rounded-lg px-2 text-sm mb-4",children:i("div",{className:"font-medium w-full py-2  block",children:"Berhasil simpan data"})}),v("label",{className:"block w-full",children:[i("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Nama"}),i("input",{type:"text",name:"nama",onChange:e=>c("nama",e.target.value),className:"mt-1 px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),v("label",{className:"block w-full mt-6",children:[i("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Alamat"}),i("input",{type:"text",name:"nik",onChange:e=>c("alamat",e.target.value),className:"mt-1 px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),i("div",{className:" text-center w-full mt-3",children:i("div",{className:"mt-4 bg-green-600 text-center py-2  px-10 rounded-lg text-white w-full",onClick:k,children:"Mulai"})})]})]})}export{W as default};
