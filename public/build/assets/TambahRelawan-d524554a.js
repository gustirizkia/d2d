import{q as R,r as n,W as $,j as i,F as G,a,b as T,g as q,f as u}from"./app-8055711d.js";import{u as B}from"./index-82545494.js";import{S as c}from"./sweetalert2.all-f29e40b6.js";function Q({session:b,provinsi:p,calon:U}){const{errors:f}=R().props;n.useEffect(()=>{console.log("errors",f)},[f]);const{data:d,setData:g,post:H,processing:O}=$({nama:null,alamat:null}),[k,x]=n.useState(null),[v,w]=n.useState(null),[y,N]=n.useState([]),[S,_]=n.useState([]),[K,D]=n.useState([]),[l,m]=n.useState({provinsi_id:0,kota_id:0,kecamatan_id:0,desa_id:0}),[h,P]=n.useState(null),{coords:s,isGeolocationAvailable:W,isGeolocationEnabled:z}=B({positionOptions:{enableHighAccuracy:!0}});n.useEffect(()=>{x(s==null?void 0:s.latitude),w(s==null?void 0:s.longitude)},[s]);const[A,r]=n.useState(!1);n.useEffect(()=>{navigator.geolocation.getCurrentPosition(e=>{r(!0)},e=>{c.fire({icon:"info",title:"Kami membutuhkan lokasi anda",text:"Aktifkan di pojok atas kiri tanda seru"}),r(!1)}),navigator.permissions.query({name:"geolocation"}).then(e=>{e.state==="denied"&&r(!1)})},[]),n.useState(!1);const C=()=>{if(!A)c.fire({icon:"info",title:"Kami membutuhkan lokasi anda",text:"Aktifkan di pojok atas kiri tanda seru"});else if(!d.nama||!d.alamat)c.fire({icon:"info",title:"Data tidak lengkap"});else{navigator.geolocation.getCurrentPosition(t=>{r(!0)},t=>{c.fire({icon:"info",title:"Kami membutuhkan lokasi anda",text:"Aktifkan di pojok atas kiri tanda seru"}),r(!1)});let e=null;if(l.provinsi_id?l.kota_id?l.kecamatan_id&&l.desa_id?h||(e="Tanggal Lahir"):e="Kecamatan":e="Kota":e="Provinsi",e)c.fire({icon:"info",title:`Silahkan Lengkapi ${e}`,text:"Data Anda Belum Lengkap"});else{let t={nama:d.nama,alamat:d.alamat,provinsi:l.provinsi_id,kota:l.kota_id,kecamatan:l.kecamatan_id,desa:l.desa_id,tanggal_lahir:h};t.latitude=k,t.longitude=v,console.log("formData",t),q.post("/addRelawan",t)}}},L=e=>{let t=e.target.value;m({...l,provinsi_id:t}),t>0&&u.get(`/listKota?provinsi=${t}`).then(o=>{N(o.data.data)}).catch(o=>{console.log("err",o)})},j=e=>{let t=e.target.value;m({...l,kota_id:t}),t>0&&u.get(`/listKecamatan?kota=${t}`).then(o=>{_(o.data.data)}).catch(o=>{console.log("err",o)})},F=e=>{let t=e.target.value;m({...l,kecamatan_id:t}),t>0&&u.get(`/listDesa?kecamatan=${t}`).then(o=>{D(o.data.data)}).catch(o=>{console.log("err",o)})},E=e=>{let t=e.target.value;console.log("value",t),m({...l,desa_id:t})};return i(G,{children:[a(T,{title:"Relawan"}),i("div",{className:"md:w-1/3  mx-auto w-full relative",children:[a("div",{className:"bg-yellow-600 h-36 w-full rounded-b-3xl p-3 font-semibold text-white",children:"Daftar Relawan"}),i("div",{className:"min-h-screen  flex justify-center flex-col items-center px-3 bg-white -mt-24 rounded-t-2xl pb-8",children:[b.success&&a("div",{className:"bg-yellow-100 w-full rounded-lg px-2 text-sm mb-4",children:a("div",{className:"font-medium w-full py-2  block",children:"Berhasil simpan data"})}),i("label",{className:"block w-full mt-4",children:[a("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Nama"}),a("input",{type:"text",name:"nama",onChange:e=>g("nama",e.target.value),className:"mt-1 px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),i("label",{className:"block w-full mt-6",children:[a("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Tanggal Lahir"}),a("input",{type:"date",name:"tanggal",onChange:e=>P(e.target.value),className:"mt-1 px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),i("label",{className:"block w-full mt-6",children:[a("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Alamat"}),a("input",{type:"text",name:"nik",onChange:e=>g("alamat",e.target.value),className:"mt-1 px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),a("label",{htmlFor:"provinsi",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Provinsi"}),i("select",{id:"provinsi",onChange:L,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[a("option",{value:0,children:"Pilih provinsi"}),p.map(e=>a("option",{value:e.id_provinsi,children:e.nama},e.id))]}),a("label",{htmlFor:"kota",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Kota/Kabupaten"}),i("select",{id:"kota",onChange:j,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[a("option",{value:0,children:"Pilih kota"}),y.map(e=>a("option",{value:e.id_kota,children:e.nama},e.id))]}),a("label",{htmlFor:"kecamatan",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Kecamatan"}),i("select",{id:"kecamatan",onChange:F,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[a("option",{value:0,children:"Pilih Kecamatan"}),S.map(e=>a("option",{value:e.id_kecamatan,children:e.nama},e.id))]}),a("label",{htmlFor:"desa",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Desa"}),i("select",{id:"desa",onChange:E,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[a("option",{value:0,children:"Pilih Desa"}),K.map(e=>a("option",{value:e.id,children:e.nama},e.id))]}),a("div",{className:" text-center w-full mt-3",children:a("div",{className:"mt-4 bg-yellow-600 text-center py-2  px-10 rounded-lg text-white w-full",onClick:C,children:"Daftar"})})]})]})]})}export{Q as default};
