import{q as O,r as l,W,j as s,F as z,a as t,b as J,g as M,f as u}from"./app-acdda539.js";import{u as Q}from"./index-e51f8f59.js";import{S as f}from"./sweetalert2.all-2e6a8dae.js";import{K as V}from"./ktp-0d6f75bf.js";import{L as X}from"./LoadingPage-614342bd.js";function ce({session:v,provinsi:w,calon:Y}){const{errors:g}=O().props,p=l.useRef(null);l.useEffect(()=>{console.log("errors",g)},[g]);const{data:d,setData:h,post:Z,processing:ee}=W({nama:null,alamat:null}),[y,N]=l.useState(null),[S,K]=l.useState(null),[P,_]=l.useState([]),[D,L]=l.useState([]),[C,F]=l.useState([]),[o,m]=l.useState({provinsi_id:0,kota_id:0,kecamatan_id:0,desa_id:0}),[b,A]=l.useState(null),[x,T]=l.useState(null),[k,R]=l.useState(null),[U,r]=l.useState(!1),{coords:i,isGeolocationAvailable:ae,isGeolocationEnabled:te}=Q({positionOptions:{enableHighAccuracy:!0}});l.useEffect(()=>{N(i==null?void 0:i.latitude),K(i==null?void 0:i.longitude)},[i]);const[le,c]=l.useState(!1);l.useEffect(()=>{navigator.geolocation.getCurrentPosition(e=>{c(!0)},e=>{c(!1)}),navigator.permissions.query({name:"geolocation"}).then(e=>{e.state==="denied"&&c(!1)})},[]),l.useState(!1);const E=()=>{p.current.click()},j=e=>{if(e.target.files.length){T(e.target.files[0]);const a=new FileReader;a.readAsDataURL(e.target.files[0]),a.onload=function(n){let H=n.target.result;R(H)}}},$=()=>{if(r(!0),!d.nama||!d.alamat)f.fire({icon:"info",title:"Data tidak lengkap"}),r(!1);else{navigator.geolocation.getCurrentPosition(a=>{c(!0)},a=>{c(!1)});let e=null;if(o.provinsi_id?o.kota_id?o.kecamatan_id&&o.desa_id?b||(e="Tanggal Lahir"):e="Kecamatan":e="Kota":e="Provinsi",e)f.fire({icon:"info",title:`Silahkan Lengkapi ${e}`,text:"Data Anda Belum Lengkap"}),r(!1);else if(!x)f.fire({icon:"info",title:"Silahkan Upload KTP",text:"Data Anda Belum Lengkap"}),r(!1);else{r(!0);const a=new FormData;a.append("nama",d.nama),a.append("alamat",d.alamat),a.append("provinsi",o.provinsi_id),a.append("kota",o.kota_id),a.append("desa",o.desa_id),a.append("kecamatan",o.kecamatan_id),a.append("tanggal_lahir",b),a.append("latitude",y),a.append("longitude",S),a.append("foto_ktp",x),M.post("/addRelawan",a)}}},B=e=>{let a=e.target.value;m({...o,provinsi_id:a}),a>0&&u.get(`/listKota?provinsi=${a}`).then(n=>{_(n.data.data)}).catch(n=>{console.log("err",n)})},G=e=>{let a=e.target.value;m({...o,kota_id:a}),a>0&&u.get(`/listKecamatan?kota=${a}`).then(n=>{L(n.data.data)}).catch(n=>{console.log("err",n)})},I=e=>{let a=e.target.value;m({...o,kecamatan_id:a}),a>0&&u.get(`/listDesa?kecamatan=${a}`).then(n=>{F(n.data.data)}).catch(n=>{console.log("err",n)})},q=e=>{let a=e.target.value;console.log("value",a),m({...o,desa_id:a})};return s(z,{children:[t(J,{title:"Relawan"}),s("div",{className:"md:w-1/3  mx-auto w-full relative",children:[U&&t(X,{}),t("div",{className:"bg-yellow-600 h-36 w-full rounded-b-3xl p-3 font-semibold text-white",children:"Daftar Relawan"}),s("div",{className:"min-h-screen  flex justify-center flex-col items-center px-3 bg-white -mt-24 rounded-t-2xl pb-8",children:[v.success&&t("div",{className:"bg-yellow-100 w-full rounded-lg px-2 text-sm mb-4",children:t("div",{className:"font-medium w-full py-2  block",children:"Berhasil simpan data"})}),s("label",{className:"block w-full mt-4",children:[t("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Nama"}),t("input",{type:"text",name:"nama",onChange:e=>h("nama",e.target.value),className:"mt-1 px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),s("label",{className:"block w-full mt-6",children:[t("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Tanggal Lahir"}),t("input",{type:"date",name:"tanggal",onChange:e=>A(e.target.value),className:"mt-1 px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),s("label",{className:"block w-full mt-6",children:[t("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Alamat"}),t("input",{type:"text",name:"nik",onChange:e=>h("alamat",e.target.value),className:"mt-1 px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),t("label",{htmlFor:"provinsi",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Provinsi"}),s("select",{id:"provinsi",onChange:B,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[t("option",{value:0,children:"Pilih provinsi"}),w.map(e=>t("option",{value:e.id_provinsi,children:e.nama},e.id))]}),t("label",{htmlFor:"kota",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Kota/Kabupaten"}),s("select",{id:"kota",onChange:G,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[t("option",{value:0,children:"Pilih kota"}),P.map(e=>t("option",{value:e.id_kota,children:e.nama},e.id))]}),t("label",{htmlFor:"kecamatan",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Kecamatan"}),s("select",{id:"kecamatan",onChange:I,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[t("option",{value:0,children:"Pilih Kecamatan"}),D.map(e=>t("option",{value:e.id_kecamatan,children:e.nama},e.id))]}),t("label",{htmlFor:"desa",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Desa"}),s("select",{id:"desa",onChange:q,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[t("option",{value:0,children:"Pilih Desa"}),C.map(e=>t("option",{value:e.id,children:e.nama},e.id))]}),t("label",{htmlFor:"KTP",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Upload KTP"}),s("div",{className:"text-center",onClick:E,children:[k?t("img",{src:k,className:"w-1/2 h-auto mx-auto rounded-lg",alt:""}):t("img",{src:V,className:"w-1/2 h-auto mx-auto",alt:""}),t("div",{className:"mt-2 text-sm",children:"Klik untuk upload KTP"}),t("input",{type:"file",ref:p,className:"",hidden:!0,accept:"image/*",capture:"camera",onChange:j})]}),t("div",{className:" text-center w-full mt-3",children:t("div",{className:"mt-4 bg-yellow-600 text-center py-2  px-10 rounded-lg text-white w-full",onClick:$,children:"Daftar"})})]})]})]})}export{ce as default};
