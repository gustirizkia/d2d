import{q as C,r as n,W as E,f as p,j as o,a,b as L,g as F}from"./app-b68dacd9.js";import{u as G}from"./index-2f4f0363.js";import{S as c}from"./sweetalert2.all-a05ec336.js";import{U as O}from"./User-c8081230.js";function M({data_soal:$,session:b,provinsi:u,getKota:f,kota:q}){const{errors:k}=C().props;n.useEffect(()=>{console.log("errors",k)},[k]);const{data:m,setData:g,post:B,processing:U}=E({nama:null,alamat:null}),[h,x]=n.useState(null),[y,v]=n.useState(null);n.useState([]);const[w,N]=n.useState([]),[S,_]=n.useState([]),[l,d]=n.useState({provinsi_id:u.id_provinsi,kota_id:0,kecamatan_id:0,desa_id:0}),{coords:s,isGeolocationAvailable:H,isGeolocationEnabled:T}=G({positionOptions:{enableHighAccuracy:!0}});n.useEffect(()=>{x(s==null?void 0:s.latitude),v(s==null?void 0:s.longitude)},[s]);const[A,r]=n.useState(!1);n.useEffect(()=>{navigator.geolocation.getCurrentPosition(e=>{r(!0)},e=>{c.fire({icon:"info",title:"Kami membutuhkan lokasi anda",text:"Aktifkan di pojok atas kiri tanda seru"}),r(!1)}),navigator.permissions.query({name:"geolocation"}).then(e=>{e.state==="denied"&&r(!1)})},[]),n.useState(!1);const K=()=>{if(!A)c.fire({icon:"info",title:"Kami membutuhkan lokasi anda",text:"Aktifkan di pojok atas kiri tanda seru"});else if(!m.nama||!m.alamat)c.fire({icon:"info",title:"Data tidak lengkap"});else{navigator.geolocation.getCurrentPosition(t=>{r(!0)},t=>{c.fire({icon:"info",title:"Kami membutuhkan lokasi anda",text:"Aktifkan di pojok atas kiri tanda seru"}),r(!1)});let e=null;if(l.provinsi_id?l.kota_id?l.kecamatan_id&&l.desa_id||(e="Kecamatan"):e="Kota":e="Provinsi",console.log("Alamat",l),e)c.fire({icon:"info",title:`Silahkan Pilih ${e}`,text:"Form Alamat Belum Lengkap"});else{let t={nama:m.nama,alamat:m.alamat,provinsi:l.provinsi_id,kota:l.kota_id,kecamatan:l.kecamatan_id,desa:l.desa_id};t.latitude=h,t.longitude=y,F.post("/inputDataTarget",t)}}};n.useEffect(()=>{D(f.id_kota)},[]);const D=e=>{let t=e;d({...l,kota_id:t}),t>0&&p.get(`/listKecamatan?kota=${t}`).then(i=>{N(i.data.data)}).catch(i=>{console.log("err",i)})},P=e=>{let t=e.target.value;d({...l,kecamatan_id:t}),t>0&&p.get(`/listDesa?kecamatan=${t}`).then(i=>{_(i.data.data)}).catch(i=>{console.log("err",i)})},j=e=>{let t=e.target.value;console.log("value",t),d({...l,desa_id:t})};return o(O,{children:[a(L,{title:"Survey"}),o("div",{className:"min-h-screen  flex justify-center flex-col items-center px-3",children:[b.success&&a("div",{className:"bg-yellow-100 w-full rounded-lg px-2 text-sm mb-4",children:a("div",{className:"font-medium w-full py-2  block",children:"Berhasil simpan data"})}),o("label",{className:"block w-full",children:[a("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Nama"}),a("input",{type:"text",name:"nama",onChange:e=>g("nama",e.target.value),className:"mt-1 px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),o("label",{className:"block w-full mt-6",children:[a("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Alamat"}),a("input",{type:"text",name:"nik",onChange:e=>g("alamat",e.target.value),className:"mt-1 px-3 py-2 bg-white border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),o("label",{className:"block w-full mt-6",children:[a("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Provinsi"}),a("input",{type:"text",readOnly:!0,name:"nama",value:u.nama,className:"mt-1 px-3 py-2 bg-gray-100 border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),o("label",{className:"block w-full mt-6",children:[a("span",{className:"after:content-['*'] after:ml-0.5 after:text-red-500 block text-sm font-medium text-slate-700",children:"Kota"}),a("input",{type:"text",readOnly:!0,name:"nama",value:f.nama,className:"mt-1 px-3 py-2 bg-gray-100 border shadow-sm border-slate-300 placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-sky-500 block w-full rounded-md sm:text-sm focus:ring-1",placeholder:"masukan nama"})]}),a("label",{htmlFor:"kecamatan",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Kecamatan"}),o("select",{id:"kecamatan",onChange:P,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[a("option",{value:0,children:"Pilih Kecamatan"}),w.map(e=>a("option",{value:e.id_kecamatan,children:e.nama},e.id))]}),a("label",{htmlFor:"desa",className:"block w-full mb-2 text-sm font-medium text-gray-900 text-left mt-6",children:"Pilih Desa"}),o("select",{id:"desa",onChange:j,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5    ",children:[a("option",{value:0,children:"Pilih Desa"}),S.map(e=>a("option",{value:e.id,children:e.nama},e.id))]}),a("div",{className:" text-center w-full mt-3",children:a("div",{className:"mt-4 bg-yellow-600 text-center py-2  px-10 rounded-lg text-white w-full",onClick:K,children:"Daftar"})})]})]})}export{M as default};
